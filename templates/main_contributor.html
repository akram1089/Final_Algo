{% extends "base_dashboard.html" %}
{% load static %}
{% block dashboard_body %}

<style>
    .filter-btn {
        font-size: 16px;
        padding: 0px 10px;
        cursor: pointer;
        color: #2196f3 !important;
        transition: prop time;
    }

    .active {
        color: #666 !important;
    }

    .contributor_name {
        color: #232222 !important;
    }

    .nifty .contributor_name {
        color: blue;
    }

    .niftynext50 .contributor_name {
        color: green;
    }

    .banknifty .contributor_name {
        color: orange;
    }

    .finnifty .contributor_name {
        color: purple;
    }

    .filter-btn:nth-child(-n+4) {
        border-right: 2px solid #666 !important;
    }

    .first_title_filter_auto_refresh {
        display: flex;
        margin: 1rem 0;
        padding: 0 1rem;
        column-gap: 35rem;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
    }

    .net_contrib_start_end_date,.left_title {
        padding: 0 1rem;
        margin: 0 0 1rem 0;
        align-items: center;
        justify-content: space-between;
        column-gap: 35rem;
    }

    .right_filter_auto {
        font-size: 12px;
        font-weight: 600;
        flex-wrap: wrap;
    }

    .start_date_contrib,
    .end_date_contrib {
        display: flex;
        align-items: center;
        gap: 0.2rem;
    }

    .right_start_end_date {
        gap: 1rem;
        white-space: nowrap;
    }

    .main_table_contrib {
        justify-content: center;
  
    }

    .text-success {
        color: rgb(7, 210, 7) !important;
    }

    #table_1_head_contrib,
    #table_2_head_contrib {
        padding: 12px 15px !important;
        font-size: 12px !important;
        text-transform: uppercase !important;
        background: #4399eb !important;
        color: #fff !important;
        /* border-right: 1px solid rgba(255, 255, 255, 0.586) !important; */
    }

    .bx-stats {
        border: 0.5px solid rgba(128, 128, 128, 0.441);
        padding: 5px 10px 1px 5px;
        height: 28px;
        width: 28px;
        border-radius: 7px;
        position: relative;
        transition: 0.3s;
        color: #2c2b2b3c;
    }

    .bx-stats:hover {
        background-color: #4399eb;
        color: white;
        border: none;
    }

    .text-bg-success {
        color: #fff !important;
        background-color: lightseagreen !important;
    }

    .badge {
        background-color: #3ab07c;
        padding: 8px 14px 8px 15px !important;
        border-radius: 14px !important;
    }

    .table_one {
        font-size: 14px !important;
        font-weight: 700 !important;
        padding: 5px 8px;
    }

    .table_two {
        font-size: 14px !important;
        font-weight: 700 !important;
        padding: 5px;
    }

    #table_1_contrib tr:nth-child(odd) {
        background-color: #FFF;
    }

    #table_1_contrib tr:nth-child(even) {
        background-color: #f0f7fd !important;
    }

    #table_2_contrib tr:nth-child(odd) {
        background-color: #FFF;
    }

    #table_2_contrib tr:nth-child(even) {
        background-color: #f0f7fd !important;
    }

    @keyframes loading {
        0% {
            background-position: -200% 0;
        }

        100% {
            background-position: 200% 0;
        }
    }

    .skeleton {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0f0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
    }

    #back_to_main_contributor{
        color: gray;
        padding: 2px 8px;
        transition: 0.3s;
        text-decoration: none;
    }
    #back_to_main_contributor:hover{
        text-decoration: none;
    background: #d5d4d4;
    color: #4399eb;
    padding: 2px 8px;
    border-radius: 10px;
    }
</style>

<div>
        
    <div class="left_title d-flex gap-2">

        <div class="last_page_contributor ">
            <a href="{% url 'contributor' %}" class="d-flex gap-1 align-items-center" id="back_to_main_contributor">            <i class='bx bx-left-arrow-alt'></i> <p style="margin-bottom: 0%;">Back</p></a>
 
        </div>
        <div class="contributor_name_main">
            <h5>
                {% if contributor == "nifty" %}
                    Nifty 50 Contributors
                {% elif contributor == "niftynext50" %}
                    Nifty Next 50 Contributors
                {% elif contributor == "banknifty" %}
                    Bank Nifty Contributors
                {% elif contributor == "finnifty" %}
                    Fin Nifty Contributors
                {% elif contributor == "midcapnifty" %}
                    Midcap Nifty Contributors
                {% elif contributor == "midcapselect" %}
                    Midcap Select Contributors
                {% else %}
                    {{ contributor }}  <!-- Fallback if no match is found -->
                {% endif %}
            </h5>
        </div>
        <div class="contributor_name d-none">
            <h5>{{ contributor }}</h5>
        </div>
        </div>


    <div class="net_contrib_start_end_date d-flex flex-wrap  mt-2">


        <div class="left_net_contrib">
            <p style="margin-bottom:auto ;" class="fw-bold">Net Contribution: <span class="text-success"
                    id="net_contribution"> </span>
            </p>
        </div>
        <div class="right_start_end_date d-flex">
            <div class="start_date_contrib">
                <label for="dateDropdown">Start Date:</label>
                <select id="dateDropdown" class="form-select form-select-sm"></select>
            </div>
            <div class="start_date_contrib">
                <label for="dateDropdown">End Date:</label>
                <input type="text" disabled value="" id="end_date" class="form-control form-control-sm"
                    style="    width: 110px;">
            </div>
        </div>
    </div>
    <!-- Other content related to the main contributor page -->
</div>


<div class="main_table_contrib row">

    <div class="left_positive_table col-md-6">
        <div class="main_positive_contrib_value d-flex justify-content-between mb-3 align-items-center">
            <div class="head_table_title_icon_up d-flex  text-success align-items-center ">
                <i class='bx bx-trending-up fs-3'></i>
                <p class="positive_contribution fs-5 fw-semibold" style="margin-bottom: auto;"></p>

            </div>
            <span class="badge"></span>
        </div>
        <div class="main_left_positive_contribution"style="overflow: auto; border-radius: 10px !important;">
        <table id="table_1_contrib" class="table table-bordered">
            <thead id="" class="bg-info">
                <th id="table_1_head_contrib" scope="col">COMPANY</th>
                <th id="table_1_head_contrib" scope="col">LTP</th>
                <th id="table_1_head_contrib" scope="col">HIGH</th>
                <th id="table_1_head_contrib" scope="col">LOW</th>
                <th id="table_1_head_contrib" scope="col">CHANGE (%)</th>
                <th id="table_1_head_contrib" scope="col">POINTS</th>
                <th id="table_1_head_contrib" scope="col">CHART</th>
            </thead>
            <tbody id="table_data1">
                <tr class="table-placeholder">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr> 
             <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>

            </tbody>
        </table>
    </div>
</div>
    <div class="right_negative col-md-6">
        <div class="main_negative_contrib_value d-flex justify-content-between mb-3 align-items-center">
            <div class="head_table_title_icon_up d-flex  text-danger align-items-center ">
                <i class='bx bx-trending-down fs-3'></i>
                <p class="negative_contribution fs-5 fw-semibold" style="margin-bottom: auto;"></p>

            </div>
            <span class="badge text-bg-danger"></span>
        </div>

        <div class="main_left_positive_contribution"style="overflow: auto; border-radius: 10px !important;">

        <table id="table_2_contrib" class="table table-bordered">
            <thead id="" class="bg-info">
                <th id="table_1_head_contrib" scope="col">COMPANY</th>
                <th id="table_1_head_contrib" scope="col">LTP</th>
                <th id="table_1_head_contrib" scope="col">HIGH</th>
                <th id="table_1_head_contrib" scope="col">LOW</th>
                <th id="table_1_head_contrib" scope="col">CHANGE (%)</th>
                <th id="table_1_head_contrib" scope="col">POINT</th>
                <th id="table_1_head_contrib" scope="col">CHART</th>
            </thead>
            <tbody>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr> 
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr> 
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr> 
         <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
                <tr class="table-placeholder d-n">
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                    <td>
                        <p class="placeholder-glow">
                            <span class="placeholder col-12"></span>
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>


    </div>
    </div>



    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>

</div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var allDates = JSON.parse('{{ all_dates|safe }}');
        console.log(allDates); // Check if the data is received properly
        var start_indices_expiries = allDates.resultData.start_date
        var max_date = allDates.resultData.max_date
        var startDateDropdown = document.getElementById('dateDropdown');
        var startDateDropdown = $('#dateDropdown');

        $.each(start_indices_expiries, function (index, expiry) {
            startDateDropdown.append($('<option></option>').val(expiry).html(expiry));
        });
        $('#end_date').val(max_date);






        $("#dateDropdown").on("change", function () {
                selectedDate_contrib = $(this).val();
                var selectedFilter_contrib=$(".contributor_name h5").text()
                localStorage.setItem('selectedDate_contrib', selectedDate_contrib);
                localStorage.setItem('selectedFilter_contrib', selectedFilter_contrib);
                fetchData(selectedDate_contrib,selectedFilter_contrib);
            });






                  // Fetch data based on selected date and filter
                  function fetchData(selectedDate_contrib,selectedFilter_contrib) {
                    console.log(selectedDate_contrib);
                    console.log(selectedFilter_contrib);
                // Show the placeholders
                $(".placeholder-glow").removeClass("d-none");

                $.ajax({
                    url: "/contributors_data",
                    type: "GET",
                    dataType: "json",
                    data: {
                        date: selectedDate_contrib,
                        filter: selectedFilter_contrib
                    },
                    success: function (response) {
                        console.log(response);
                        var All_stocks_data = {};

                        // Create an object to store all stock data
                        var All_stocks_data = {};

                        // Loop through stocks_data to calculate price difference and merge data
                        for (var i = 0; i < response.stocks_data.length; i++) {
                            var stock = response.stocks_data[i];
                            var closingPrice = stock.closing_price || 0;
                            var lastTradePrice = stock.last_trade_price || 0;
                            var priceDifference = lastTradePrice - closingPrice;

                            stock.price_difference = priceDifference;
                            stock.price_difference_percent = closingPrice !== 0 ? (priceDifference / closingPrice) * 100 : 0;

                            // Merge stock data into All_stocks_data using symbol_name as key
                            All_stocks_data[stock.symbol_name] = stock;
                        }

                        console.log("All Stocks Data:", All_stocks_data);

                        // Split data into positive and negative priceDifference
                        var positiveData = [];
                        var negativeData = [];

                        for (var symbol in All_stocks_data) {
                            console.log(symbol);
                            if (All_stocks_data.hasOwnProperty(symbol)) {
                                var stockData = All_stocks_data[symbol];
                                if (stockData.points >= 0) {
                                    positiveData.push(stockData);
                                } else {
                                    negativeData.push(stockData);
                                }
                            }
                        }

                        console.log("Positive Data:", positiveData);
                        console.log("Negative Data:", negativeData);


                        displayPositiveData(positiveData);
                        displayNegativeData(negativeData);
                        $("#end_date").val(response.date_max)

                        // Calculate and display index
                        var positiveIndex = calculateIndex(positiveData);
                        var negativeIndex = calculateIndex(negativeData);

                        $(".positive_contribution").text("Positive Contributors (" + positiveIndex + ")");
                        $(".negative_contribution").text("Negative Contributors (" + negativeIndex + ")");

                        // Hide the placeholders
                        $(".placeholder-glow").addClass("d-none");

                   
                        net_contribution()
                    }
                });
            }

    // Display positive_price_difference data
function displayPositiveData(data) {
    var positiveTableBody = $("#table_1_contrib tbody");
    var poistive_badge = $(".main_positive_contrib_value .badge");
    var poistive_points = 0;

    // Sort the data array by points in descending order
    data.sort(function (a, b) {
        return b.points - a.points;
    });

    var color_array = ["#027ec5", "#3a83c3", "#ae7081", "#0b9644", "#292075", "#1b30d6", "rgb(0, 0, 0)", "rgb(192, 6, 24)", "rgb(4, 76, 155)"]

    positiveTableBody.empty();

    if (data.length === 0) {
        var noRecordRow = "<tr><td colspan='7' style='text-align: center;'>No record found!</td></tr>";
        positiveTableBody.append(noRecordRow);
    } else {
        for (var i = 0; i < data.length; i++) {
            var row = "<tr>" +
                "<td>" + "<div class='table_one' style='text-align:center;' >" + data[i].symbol_name + "</div>" + "</td>" +
                "<td>" + "<div class='table_one'>" + data[i].last_trade_price + "</div>" + "</td>" +
                "<td>" + "<div class='table_one'>" + data[i].high + "</div>" + "</td>" +
                "<td>" + "<div class='table_one'>" + data[i].low + "</div>" + "</td>" +
                "<td>" + "<div class='table_one justify-content-between' style='color:#167f18e0; display:flex; align-items:center;'>" + data[i].change_value.toFixed(2) + "<div class='ms-4' style='background-color:#32cd4c2e; border-radius:7px; padding:4px; display: flex;align-items: center;'> <i class='bx bx-up-arrow-alt'></i>" + data[i].change_per.toFixed(2) + "%" + "</div>" + "</div>" + "</td>" +
                "<td>" + "<div class='table_one'>" + data[i].points + "</div>" + "</td>" +
                "<td class='text-center'><div class='table_one'> <a target='_blank' href='https://www.tradingview.com/chart/?symbol=" + data[i].symbol_name + "&aff_id=113877'><i class='bx bx-stats'></i></a> </div></td>" +
                "</tr>";
            poistive_points += data[i].points;
            positiveTableBody.append(row);
        }
    }

    poistive_badge.text(poistive_points.toFixed(2));
}


// Display negative_price_difference data
function displayNegativeData(data) {
    var negativeTableBody = $("#table_2_contrib tbody");
    var negative_badge = $(".main_negative_contrib_value .badge");
    var negative_points = 0;

    data.sort(function (a, b) {
        return b.points - a.points;
    });

    var color_bg_array = ["#987f4b", "rgb(234, 35, 36)", "rgb(0, 0, 0)", "rgb(34, 48, 104)", "rgb(91, 143, 49)", "rgb(94, 11, 47)", "rgb(0, 0, 0)", "rgb(192, 6, 24)", "rgb(4, 76, 155)"];
    negativeTableBody.empty();

    if (data.length === 0) {
        var noRecordRow = "<tr><td colspan='7' style='text-align: center;'>No record found!</td></tr>";
        negativeTableBody.append(noRecordRow);
    } else {
        for (var j = 0; j < data.length; j++) {
            var row = "<tr>" +
                "<td> <div class='table_two' style='text-align:center;'>" + data[j].symbol_name + "</div></td>" +
                "<td> <div class='table_two'>" + data[j].last_trade_price + "</div></td>" +
                "<td> <div class='table_two'>" + data[j].high + "</div></td>" +
                "<td> <div class='table_two'>" + data[j].low + "</div></td>" +
                "<td class='text-danger'> <div class='table_two  justify-content-between' style='color:rgb(196 0 0); display:flex; align-items:center;'>" + data[j].change_value.toFixed(2) + "<div class='ms-4' style='background-color:#cd32322e; border-radius:7px; padding:4px; display: flex;align-items: center;'> <i class='bx bx-down-arrow-alt'></i>" + data[j].change_per.toFixed(2) + "%" + "</div>" + "</div></td>" +
                "<td>" + data[j].points + "</td>" +
                "<td> <div class='table_two'><a target='_blank' href='https://www.tradingview.com/chart/?symbol=" + data[j].symbol_name + "&aff_id=113877'><i class='bx bx-stats'></i></a></div></td>" +
                "</tr>";
            negative_points += data[j].points;
            negativeTableBody.append(row);
        }
    }

    negative_badge.text(negative_points.toFixed(2));
}

            // Calculate index based on data length
            function calculateIndex(data) {
                return data.length;
            }

            // Set active filter on page load
            function net_contribution() {
                var negative_badge = parseFloat($(".main_negative_contrib_value .badge").text());
                console.log(negative_badge);

                var poistive_badge = parseFloat($(".main_positive_contrib_value .badge").text());
                console.log(poistive_badge);

                // Convert values to positive numbers using Math.abs()
                negative_badge = Math.abs(negative_badge);
                poistive_badge = Math.abs(poistive_badge);
                main_badge = poistive_badge - negative_badge
                console.log(main_badge);
                if (main_badge > 0) {
                    $("#net_contribution").addClass("text-success")
                    $("#net_contribution").removeClass("text-danger")
                }
                else {
                    $("#net_contribution").addClass("text-danger")
                    $("#net_contribution").removeClass("text-success")

                }
                $("#net_contribution").text(main_badge.toFixed(2));
            }


         var selectedDate_contrib=   $("#dateDropdown").val();
                
           
            var selectedFilter_contrib=$(".contributor_name h5").text()
            localStorage.setItem('selectedDate_contrib', selectedDate_contrib);
                localStorage.setItem('selectedFilter_contrib', selectedFilter_contrib);
          
            fetchData(selectedDate_contrib,selectedFilter_contrib);

    });
</script>

{% endblock dashboard_body %}